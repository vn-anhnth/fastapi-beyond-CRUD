- https://jod35.github.io/fastapi-beyond-crud-docs/site/chapter5/
- https://github.com/zhanymkanov/fastapi-best-practices
- https://github.com/teamhide/fastapi-boilerplate/tree/master
- Log: https://gist.github.com/liviaerxin/d320e33cbcddcc5df76dd92948e5be3b
-
- gunicorn -w 4 -k uvicorn.workers.UvicornWorker src.main:app --bind 0.0.0.0:8000
- uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
- gunicorn -w $(python3 -c "import multiprocessing; print((multiprocessing.cpu_count() * 2) + 1)") -k uvicorn.workers.UvicornWorker --preload src.main:app --bind 0.0.0.0:8000
  -  Nếu server có 4 CPU core, số worker tự động thành (2 × 4) + 1 = 9.
- Kiểm tra container:
  - docker-compose -f docker-compose.yml ps
- Dừng container:
  - docker-compose -f docker-compose.yml down
- Xem logs:
  - docker-compose -f docker-compose.yml logs -f
- docker volume ls
- docker volume rm <tên_volume>
-
- https://testdriven.io/blog/fastapi-sqlmodel/
- alembic revision --autogenerate -m "create users table"
- alembic upgrade head
- Rollback về migration trước đó
  - alembic downgrade -1
- Khi bạn chạy docker-compose up, Docker Compose sẽ load các biến môi trường này vào môi trường shell của bạn, do đó bên phải set lại DATABASE_URL với localhost
  - DATABASE_URL=postgresql+asyncpg://bookly_user:bookly_password@localhost:5432/bookly_db alembic revision --autogenerate -m "add role to users table"
-
- ruff check
- ruff check src/books/service.py --select I --fix
- ruff check --select I
-
- Kiểm tra container đang sử dụng volume
  - docker ps -a --filter volume=fastapi-beyond-crud_postgres_data
- docker rm -f 6a6e9420d7dc
- docker volume rm fastapi-beyond-crud_postgres_data
- Xóa container & volume
  - docker compose down -v
-
- Note
  - exec() nó mở transaction mà tự động đóng